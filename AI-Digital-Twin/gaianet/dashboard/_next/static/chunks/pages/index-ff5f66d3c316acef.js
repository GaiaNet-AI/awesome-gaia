(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{48312:function(e,t,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return l(45531)}])},45531:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return eR}});var r,s,a=l(85893),n=l(67294),i=l(41664),o=l.n(i),d=l(9008),c=l.n(d);let x=e=>{let{initialState:t}=e,l=(e,l)=>{if(!l.type)return{...e,[l.field]:l.value};if("reset"===l.type)return t;throw Error()},[r,s]=(0,n.useReducer)(l,t);return(0,n.useMemo)(()=>({state:r,dispatch:s}),[r,s])};var p=l(83454);let m=()=>{let e=async e=>{let t=await fetch("/v1/models",{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e.key?e.key:p.env.OPENAI_API_KEY)}}),l=await t.json(),r=l.data;return r&&r.length>0?{name:r[0].id,subdomain:e.url}:{}};return{getModels:e}};(r=s||(s={})).GPT_3_5="gpt-3.5-turbo",r.LLAMA_2_CHAT="llama-2-chat",r.GPT_3_5_AZ="gpt-35-turbo",r.GPT_4="gpt-4",r.GPT_4_32K="gpt-4-32k",s.LLAMA_2_CHAT;let u={[s.GPT_3_5]:{id:s.GPT_3_5,name:"GPT-3.5",maxLength:12e3,tokenLimit:4e3},[s.LLAMA_2_CHAT]:{id:s.LLAMA_2_CHAT,name:"LLAMA_2_CHAT",maxLength:12e3,tokenLimit:4e3},[s.GPT_3_5_AZ]:{id:s.GPT_3_5_AZ,name:"GPT-3.5",maxLength:12e3,tokenLimit:4e3},[s.GPT_4]:{id:s.GPT_4,name:"GPT-4",maxLength:24e3,tokenLimit:8e3},[s.GPT_4_32K]:{id:s.GPT_4_32K,name:"GPT-4-32K",maxLength:96e3,tokenLimit:32e3}};var h=l(83454);h.env.NEXT_PUBLIC_DEFAULT_SYSTEM_PROMPT,h.env.OPENAI_API_HOST;let f=parseFloat(h.env.NEXT_PUBLIC_DEFAULT_TEMPERATURE||"1");h.env.OPENAI_API_TYPE,h.env.OPENAI_API_VERSION,h.env.OPENAI_ORGANIZATION,h.env.AZURE_DEPLOYMENT_ID;let g=e=>Array.isArray(e)?e.reduce((e,t)=>{try{t.model||(t.model=u[s.GPT_3_5]),t.temperature||(t.temperature=f),t.folderId||(t.folderId=null),t.messages||(t.messages=[]),e.push(t)}catch(e){console.warn("error while cleaning conversations' history. Removing culprit",e)}return e},[]):(console.warn("history is not an array. Returning an empty array."),[]),v=(e,t,l)=>{let r=t.map(t=>t.id===e.id?e:t);return b(e),w(r,l),{single:e,all:r}},b=e=>{localStorage.setItem("selectedConversation",JSON.stringify(e))},w=(e,t)=>{localStorage.setItem("conversationHistory",JSON.stringify(e))},j=e=>{localStorage.setItem("folders",JSON.stringify(e))},y=e=>{localStorage.setItem("prompts",JSON.stringify(e))},C=()=>{let e={theme:"dark",isStream:!0},t=localStorage.getItem("settings");if(t)try{let l=JSON.parse(t);e=Object.assign(e,l)}catch(e){console.error(e)}return e};var N=l(61162);let k=async(e,t,l,r,s,a)=>{let n;n=t?[{role:"system",content:t},...a]:a;let i=await fetch("/v1/chat/completions",{headers:{accept:"application/json","Content-Type":"text/event-stream"},method:"POST",body:JSON.stringify({model:e.name,messages:n,stream:!0,stream_options:{include_usage:!0}})});return i.body},S=async(e,t,l,r,s,a)=>{let n=await fetch("/v1/chat/completions",{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({model:e.name,messages:[{role:"system",content:t},...a],stream:!1})});return await n.json()},L=(0,n.createContext)(void 0);var _=l(63072);let A=e=>{let{prompts:t,activePromptIndex:l,onSelect:r,onMouseOver:s,promptListRef:n}=e;return(0,a.jsx)("ul",{ref:n,className:"z-10 max-h-52 w-full overflow-scroll rounded border border-black/10 bg-white shadow-[0_0_10px_rgba(0,0,0,0.10)] dark:border-neutral-500 dark:bg-[#343541] dark:text-white dark:shadow-[0_0_15px_rgba(0,0,0,0.10)]",children:t.map((e,t)=>(0,a.jsx)("li",{className:"".concat(t===l?"bg-gray-200 dark:bg-[#202123] dark:text-black":""," cursor-pointer px-3 py-2 text-sm text-black dark:text-white"),onClick:e=>{e.preventDefault(),e.stopPropagation(),r()},onMouseEnter:()=>s(t),children:e.name},e.id))})},P=e=>{let{prompt:t,variables:l,onSubmit:r,onClose:s}=e,[i,o]=(0,n.useState)(l.map(e=>({key:e,value:""})).filter((e,t,l)=>l.findIndex(t=>t.key===e.key)===t)),d=(0,n.useRef)(null),c=(0,n.useRef)(null),x=(e,t)=>{o(l=>{let r=[...l];return r[e].value=t,r})},p=()=>{if(i.some(e=>""===e.value)){alert("Please fill out all variables");return}r(i.map(e=>e.value)),s()},m=e=>{"Enter"!==e.key||e.shiftKey?"Escape"===e.key&&s():(e.preventDefault(),p())};return(0,n.useEffect)(()=>{let e=e=>{d.current&&!d.current.contains(e.target)&&s()};return window.addEventListener("click",e),()=>{window.removeEventListener("click",e)}},[s]),(0,n.useEffect)(()=>{c.current&&c.current.focus()},[]),(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onKeyDown:m,children:(0,a.jsxs)("div",{ref:d,className:"dark:border-netural-400 inline-block max-h-[400px] transform overflow-y-auto rounded-lg border border-gray-300 bg-white px-4 pt-5 pb-4 text-left align-bottom shadow-xl transition-all dark:bg-[#202123] sm:my-8 sm:max-h-[600px] sm:w-full sm:max-w-lg sm:p-6 sm:align-middle",role:"dialog",children:[(0,a.jsx)("div",{className:"mb-4 text-xl font-bold text-black dark:text-neutral-200",children:t.name}),(0,a.jsx)("div",{className:"mb-4 text-sm italic text-black dark:text-neutral-200",children:t.description}),i.map((e,t)=>(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("div",{className:"mb-2 text-sm font-bold text-neutral-200",children:e.key}),(0,a.jsx)("textarea",{ref:0===t?c:void 0,className:"mt-1 w-full rounded-lg border border-neutral-500 px-4 py-2 text-neutral-900 shadow focus:outline-none dark:border-neutral-800 dark:border-opacity-50 dark:bg-[#40414F] dark:text-neutral-100",style:{resize:"none"},placeholder:"Enter a value for ".concat(e.key,"..."),value:e.value,onChange:e=>x(t,e.target.value),rows:3})]},t)),(0,a.jsx)("button",{className:"mt-6 w-full rounded-lg border border-neutral-500 px-4 py-2 text-neutral-900 shadow hover:bg-neutral-100 focus:outline-none dark:border-neutral-800 dark:border-opacity-50 dark:bg-white dark:text-black dark:hover:bg-neutral-300",onClick:p,children:"Submit"})]})})},I=e=>{var t;let{onSend:l,onRegenerate:r,maxImg:s,onScrollDownClick:i,stopConversationRef:o,textareaRef:d,showScrollDownButton:c}=e,{t:x}=(0,N.$G)("chat"),{state:{selectedConversation:p,messageIsStreaming:m,prompts:u},dispatch:h}=(0,n.useContext)(L),[f,g]=(0,n.useState)(),[v,b]=(0,n.useState)(!1),[w,j]=(0,n.useState)(!1),[y,C]=(0,n.useState)(0),[k,S]=(0,n.useState)(""),[I,E]=(0,n.useState)([]),[T,z]=(0,n.useState)(!1),[O,D]=(0,n.useState)(!1),[Z,M]=(0,n.useState)(null),[R,H]=(0,n.useState)(!1),[F,G]=(0,n.useState)(""),J=(0,n.useRef)(null),K=u.filter(e=>e.name.toLowerCase().includes(k.toLowerCase())),B=e=>{let t=e.target.value;g(t),Y(t)},U=()=>{let e=ee;if(R&&(e=ea()),m)return;if(!f){alert(x("Please enter a message"));return}let t=f;e.length>0&&(t=[{type:"text",text:f}],e.forEach(e=>{Array.isArray(t)&&t.push({type:"image_url",image_url:{url:e}})})),l({role:"user",content:t},Z),g(""),et([]),M(null),window.innerWidth<640&&d&&d.current&&d.current.blur()},V=()=>{let e=void 0===window.navigator?"":navigator.userAgent;return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile|mobile|CriOS/i.test(e)},$=()=>{let e=K[y];e&&(g(t=>null==t?void 0:t.replace(/\/\w*$/,e.content)),q(e)),j(!1)},W=e=>{w?"ArrowDown"===e.key?(e.preventDefault(),C(e=>e<u.length-1?e+1:e)):"ArrowUp"===e.key?(e.preventDefault(),C(e=>e>0?e-1:e)):"Tab"===e.key?(e.preventDefault(),C(e=>e<u.length-1?e+1:0)):"Enter"===e.key?(e.preventDefault(),$()):"Escape"===e.key?(e.preventDefault(),j(!1)):C(0):"Enter"!==e.key||v||V()||e.shiftKey?"/"===e.key&&e.metaKey&&(e.preventDefault(),D(!O)):(e.preventDefault(),U())},X=e=>{let t;let l=/{{(.*?)}}/g,r=[];for(;null!==(t=l.exec(e));)r.push(t[1]);return r},Y=(0,n.useCallback)(e=>{let t=e.match(/\/\w*$/);t?(j(!0),S(t[0].slice(1))):(j(!1),S(""))},[]),q=e=>{let t=X(e.content);E(t),t.length>0?z(!0):(g(t=>null==t?void 0:t.replace(/\/\w*$/,e.content)),Y(e.content))},Q=e=>{let t=null==f?void 0:f.replace(/{{(.*?)}}/g,(t,l)=>{let r=I.indexOf(l);return e[r]});g(t),d&&d.current&&d.current.focus()};(0,n.useEffect)(()=>{J.current&&(J.current.scrollTop=30*y)},[y]),(0,n.useEffect)(()=>{if(d&&d.current){var e,t;d.current.style.height="inherit",d.current.style.height="".concat(null===(e=d.current)||void 0===e?void 0:e.scrollHeight,"px"),d.current.style.overflow="".concat((null==d?void 0:null===(t=d.current)||void 0===t?void 0:t.scrollHeight)>400?"auto":"hidden")}},[f]),(0,n.useEffect)(()=>{let e=e=>{J.current&&!J.current.contains(e.target)&&j(!1)};return window.addEventListener("click",e),()=>{window.removeEventListener("click",e)}},[]);let[ee,et]=(0,n.useState)([]),el=e=>{let t=e.target.files;if(t){let e=[],l=[];for(let r=0;r<t.length;r++){let s=t[r],a=new FileReader;l.push(new Promise(t=>{a.onloadend=()=>{e.push(a.result),t()}})),a.readAsDataURL(s)}Promise.all(l).then(()=>{er(e)})}},er=e=>{let t;if(ee.length+e.length<=s)t=[...ee,...e];else{let l=[...e,...e];t=l.slice(-s)}return et(t),t},es=e=>{et(t=>{let l=[...t];return l.splice(e,1),l})},ea=()=>{let e=[];return H(!1),F&&(e=er([F]),G("")),e};return(0,a.jsxs)("div",{className:"bottom-0 left-0 w-full pt-6 bg-fontLight",children:[(0,a.jsx)("input",{type:"file",accept:"image/*",onChange:el,style:{display:"none"},id:"upload-button"}),(0,a.jsx)("div",{className:"stretch mx-2 flex flex-row gap-3 last:mb-2 md:mx-4 md:last:mb-6 lg:mx-auto lg:max-w-5xl",children:(0,a.jsxs)("div",{className:"relative mx-2 flex w-full flex-grow flex-col rounded-full border bg-fontLight justify-center sm:mx-4",children:[(0,a.jsxs)("div",{className:"flex justify-center"+(ee.length>0?" mt-4":""),children:[(0,a.jsx)("button",{title:"upload image file",disabled:0===s,className:"group p-2 "+(0===s?" cursor-not-allowed":""),onClick:()=>{var e;null===(e=document.getElementById("upload-button"))||void 0===e||e.click()},children:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"14",viewBox:"0 0 18 14",fill:"none",children:(0,a.jsx)("path",{d:"M8.99023 13.0137C8.64844 13.0137 8.36523 12.7324 8.35742 12.3887V8.08984L7.23633 9.20117C7.11523 9.31836 6.95508 9.38476 6.78516 9.38476C6.61523 9.38476 6.45508 9.32031 6.33203 9.20117C6.21484 9.08594 6.14844 8.93359 6.14453 8.76758C6.14258 8.60156 6.20508 8.44531 6.32031 8.32617L6.33203 8.31445L8.51562 6.16797L8.51758 6.16602C8.64062 6.0293 8.81055 5.95312 8.99609 5.95312C9.16797 5.95312 9.32812 6.01758 9.45117 6.13672L11.666 8.31055C11.7852 8.42773 11.8516 8.58594 11.8516 8.75391C11.8516 8.92187 11.7852 9.07812 11.666 9.19727C11.5449 9.31445 11.3828 9.38086 11.2148 9.38086C11.0449 9.38086 10.8848 9.31641 10.7617 9.19727L9.63672 8.0918V12.3887C9.63281 12.7324 9.34766 13.0137 9 13.0137H8.99023ZM3.46484 12.3906C1.6875 12.3906 0.242188 10.9707 0.242188 9.22656C0.242188 8.43164 0.542969 7.66992 1.08984 7.08594C1.63281 6.50391 2.37109 6.14453 3.16992 6.07422L3.26367 6.06641L3.26172 5.97266C3.23242 4.99609 3.76758 3.8418 4.69531 2.88477C5.86523 1.67773 7.43359 0.986328 8.99805 0.986328C11.9277 0.986328 14.4043 3.13867 14.7617 5.99219L14.7734 6.08008H14.8867C15.5938 6.08008 16.3164 6.41602 16.8672 7.00195C17.4414 7.61328 17.7598 8.40234 17.7598 9.22851C17.7598 10.9414 16.3672 12.3398 14.6367 12.3906V12.3887H12.6914C12.3398 12.3887 12.0547 12.1094 12.0547 11.7637C12.0586 11.4199 12.3418 11.1387 12.6875 11.1387H14.541C15.6133 11.1387 16.4863 10.2812 16.4863 9.22656C16.4863 8.17188 15.6133 7.31445 14.541 7.31445H13.5293V6.69531C13.5293 4.24023 11.498 2.24414 9.00391 2.24414C6.50781 2.24414 4.47852 4.24023 4.47852 6.69531V7.32031H3.4668C2.39453 7.32031 1.52148 8.17773 1.52148 9.23242C1.52148 10.2871 2.39453 11.1445 3.4668 11.1445H5.32422C5.66797 11.1445 5.94922 11.4238 5.95312 11.7695C5.94922 12.1133 5.66602 12.3945 5.32031 12.3945L3.46484 12.3906Z",fill:"#121314",className:"fill-[#A4A3A3] group-hover:fill-[#121314] transition-all"})})}),R?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("input",{onChange:e=>{G(e.target.value)},id:"imgUrlInputBox",autoFocus:!0,style:{height:"2.25rem"},className:"px-2 h-full text-fontPrimary text-[14px] font-MonaspaceNeon bg-[#ffffff] border-fillLine border-l border-t border-b outline-none rounded-l-lg"}),(0,a.jsx)("button",{title:"upload",className:"px-2 h-9 text-fontPrimary text-[14px] font-MonaspaceNeon border-t border-r border-b border-fillLine rounded-r-lg",onClick:ea,children:F?"Submit":"Close"})]}):(0,a.jsx)("button",{disabled:0===s,title:"Upload images by entering the url",className:"group p-2 pr-5"+(0===s?" cursor-not-allowed":""),onClick:()=>{H(!0)},children:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:(0,a.jsx)("path",{d:"M7.19593 18.5C6.72973 18.4984 6.26895 18.3999 5.84282 18.2108C5.41668 18.0217 5.03449 17.7461 4.72047 17.4015L4.70129 17.3797C4.03714 16.6379 3.66992 15.6772 3.66992 14.6815C3.66992 13.6859 4.03714 12.7252 4.70129 11.9833L4.95629 11.7044C5.01379 11.639 5.08451 11.5865 5.16378 11.5504C5.24305 11.5144 5.32907 11.4955 5.41616 11.4951C5.47061 11.4958 5.52476 11.5031 5.57744 11.5169C5.69025 11.5512 5.7919 11.6149 5.87195 11.7015C5.952 11.788 6.00757 11.8944 6.03296 12.0095C6.06175 12.1271 6.06089 12.25 6.03046 12.3671C6.00002 12.4843 5.94097 12.5921 5.8586 12.6808L5.60273 12.9597C5.3198 13.2741 5.11859 13.6533 5.01688 14.0638C4.91516 14.4743 4.91606 14.9035 5.01949 15.3136C5.11129 15.7148 5.30667 16.0849 5.58614 16.387C5.86562 16.6891 6.21942 16.9127 6.61226 17.0354C6.80163 17.0911 6.9981 17.119 7.19549 17.1182C7.49577 17.1169 7.79247 17.053 8.0667 16.9307C8.34093 16.8083 8.58667 16.6302 8.78826 16.4077L11.8531 13.0862C12.1553 12.7482 12.3636 12.3369 12.4571 11.8932C12.5505 11.4495 12.5259 10.9891 12.3857 10.558C12.2589 10.1383 12.0153 9.76347 11.6834 9.47711C11.3515 9.19076 10.945 9.00474 10.5114 8.94077C10.4263 8.93103 10.3442 8.90348 10.2704 8.85993C10.1967 8.81637 10.1329 8.75777 10.0833 8.68795C9.97633 8.54235 9.92781 8.36194 9.94731 8.18231C9.95704 8.01934 10.0274 7.8659 10.1445 7.75217C10.2616 7.63843 10.4171 7.57263 10.5802 7.5677C10.604 7.56697 10.6278 7.56843 10.6513 7.57205C11.3208 7.65419 11.9502 7.93508 12.4585 8.37846C12.988 8.83675 13.3803 9.4327 13.5919 10.1003C13.8126 10.7832 13.8509 11.512 13.703 12.2144C13.5617 12.9048 13.235 13.5438 12.758 14.0626L9.69231 17.3797C9.37773 17.7307 8.993 18.0118 8.56299 18.2048C8.13298 18.3977 7.66725 18.4983 7.19593 18.5ZM9.74724 12.4192C9.27714 12.414 8.81319 12.3117 8.3844 12.119C7.95561 11.9262 7.5712 11.6471 7.25521 11.299C6.59107 10.5572 6.22384 9.59645 6.22384 8.60077C6.22384 7.60509 6.59107 6.64438 7.25521 5.90257L10.3209 2.58539C10.6362 2.24047 11.0204 1.96563 11.4487 1.77867C11.877 1.59171 12.3398 1.4968 12.8071 1.50008C13.2745 1.50337 13.7359 1.60478 14.1615 1.79775C14.5871 1.99072 14.9675 2.27094 15.2779 2.62026C15.9378 3.35557 16.3053 4.30719 16.311 5.29515C16.3167 6.28312 15.9602 7.23892 15.3089 7.9818L15.0547 8.26077C14.9974 8.32239 14.9277 8.3713 14.8503 8.40434C14.7729 8.43738 14.6894 8.45381 14.6052 8.45258C14.5211 8.45135 14.4381 8.43248 14.3617 8.39718C14.2853 8.36189 14.2171 8.31097 14.1616 8.24769C14.0433 8.11469 13.9773 7.94329 13.9759 7.76532C13.9744 7.58735 14.0376 7.41491 14.1537 7.28L14.4087 7.00539C14.6951 6.69119 14.8994 6.31112 15.0035 5.89896C15.1076 5.48681 15.1083 5.05531 15.0055 4.64282C14.9132 4.23966 14.7168 3.86772 14.436 3.56409C14.1551 3.26046 13.7996 3.03573 13.4049 2.91231C13.2172 2.86016 13.0233 2.83377 12.8286 2.83385C12.5251 2.83704 12.2255 2.90342 11.949 3.02875C11.6726 3.15408 11.4252 3.33561 11.2227 3.5618L8.15708 6.87462C7.83158 7.24017 7.61573 7.69009 7.53431 8.17275C7.4529 8.6554 7.5092 9.15123 7.69678 9.60334C7.85865 10.0185 8.13997 10.3763 8.50518 10.6315C8.87038 10.8868 9.30307 11.0281 9.74854 11.0374C9.79606 11.0374 9.84401 11.0374 9.89152 11.0331C9.90808 11.0331 9.92421 11.0287 9.9399 11.0287C10.0473 11.0307 10.1525 11.0602 10.2453 11.1144C10.3381 11.1685 10.4154 11.2456 10.47 11.3382C10.533 11.4416 10.5696 11.5589 10.5766 11.6797C10.5836 11.8006 10.5607 11.9213 10.5101 12.0313C10.4632 12.1374 10.3883 12.2287 10.2935 12.2955C10.1986 12.3623 10.0874 12.4021 9.97172 12.4105C9.89631 12.4149 9.82134 12.4192 9.74724 12.4192Z",className:"fill-[#A4A3A3] group-hover:fill-[#121314] transition-all"})})}),(0,a.jsx)("div",{className:"bg-fillTertiary w-0.5 h-auto my-3"}),(0,a.jsx)("textarea",{ref:d,className:"rounded-r-full m-0 w-full resize-none border-0 outline-none bg-fontLight p-0 py-2  pr-20 md:pr-28 pl-5 text-fontPrimary text-[14px] leading-[20px] tracking-[0.56px] font-PPSupplySans placeholder:text-[#D2D2D2] md:py-3 md:pl-5 h-[56px] md:h-auto",style:{resize:"none",bottom:"".concat(null==d?void 0:null===(t=d.current)||void 0===t?void 0:t.scrollHeight,"px"),maxHeight:"400px",overflow:"".concat(d.current&&d.current.scrollHeight>400?"auto":"hidden")},placeholder:x('Type a message or type "/" to select a prompt...')||"",value:f,rows:1,onCompositionStart:()=>b(!0),onCompositionEnd:()=>b(!1),onChange:B,onKeyDown:W})]}),(0,a.jsx)("button",{className:"absolute right-2 top-2 rounded-sm p-1 inline-flex items-center gap-2 cursor-pointer",onClick:U,children:m?(0,a.jsx)("div",{className:"h-4 w-4 animate-spin rounded-full border-t-2 border-neutral-800 flex justify-center items-center"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",children:[(0,a.jsx)("g",{clipPath:"url(#clip0_4682_3886)",children:(0,a.jsx)("path",{d:"M14.0001 5.5V8.4C14.0001 8.9 13.6001 9.4 13.0001 9.4L4.00015 9.5V6.9C4.00015 6.6 3.60015 6.4 3.40015 6.6L0.100146 10.2C0.000146488 10.4 0.000146488 10.6 0.100146 10.8L3.40015 14.4C3.60015 14.6 4.00015 14.5 4.00015 14.1V11.5L13.0001 11.4C14.6001 11.4 16.0001 10 16.0001 8.4V5.5H14.0001Z",fill:"#121314"})}),(0,a.jsx)("defs",{children:(0,a.jsx)("clipPath",{id:"clip0_4682_3886",children:(0,a.jsx)("rect",{width:"16",height:"16",fill:"white"})})})]}),(0,a.jsx)("p",{className:"text-[15px] leading-[20px] tracking-[0.9px] font-MonaspaceNeon text-fontPrimary uppercase",children:"Send"})]})}),c&&(0,a.jsx)("div",{className:"absolute bottom-12 right-0 lg:bottom-0 lg:-right-10",children:(0,a.jsx)("button",{className:"flex h-7 w-7 items-center justify-center rounded-full bg-fontPrimary text-fontLight outline-none ",onClick:i,children:(0,a.jsx)(_.Z,{size:18})})}),w&&K.length>0&&(0,a.jsx)("div",{className:"absolute bottom-12 w-full",children:(0,a.jsx)(A,{activePromptIndex:y,prompts:K,onSelect:$,onMouseOver:C,promptListRef:J})}),T&&(0,a.jsx)(P,{prompt:K[y],variables:I,onSubmit:Q,onClose:()=>z(!1)})]})}),(0,a.jsx)("div",{className:"lg:mx-auto lg:max-w-5xl",children:(0,a.jsx)("div",{className:"flex mx-2 sm:mx-4"+(ee.length>0?" mt-4":""),children:ee.map((e,t)=>(0,a.jsx)("div",{style:{position:"relative",display:"inline-block",marginRight:"10px"},children:(0,a.jsxs)("div",{style:{width:"100px",height:"100px",borderRadius:"5px",border:"1px dashed #ccc",overflow:"hidden",position:"relative"},children:[(0,a.jsx)("img",{src:e,alt:"Uploaded",style:{width:"100%",height:"100%",objectFit:"cover"}}),(0,a.jsx)("div",{style:{position:"absolute",top:"5px",right:"5px",cursor:"pointer"},onClick:()=>es(t),children:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-x-circle",viewBox:"0 0 16 16",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zM7.354 8l-2.88 2.879a.5.5 0 0 1-.708-.708L6.646 8 3.766 5.121a.5.5 0 0 1 .708-.708L8 7.354l2.879-2.88a.5.5 0 0 1 .708.708L8.354 8l2.879 2.879a.5.5 0 0 1-.708.708L8 8.354 5.121 11.233a.5.5 0 0 1-.708-.708L7.354 8z"})})})]})},t))})}),(0,a.jsx)("div",{className:"mt-4 pb-4 flex items-center justify-center gap-5 md:gap-10",children:[{name:"X",href:"https://twitter.com/Gaianet_AI"},{name:"Discord",href:"https://discord.com/invite/gaianet-ai"},{name:"Telegram",href:"https://t.me/Gaianet_AI"},{name:"Github",href:"https://github.com/GaiaNet-AI"},{name:"Huggingface",href:"https://huggingface.co/gaianet"}].map(e=>(0,a.jsx)("a",{href:e.href,target:"_blank",rel:"noreferrer",className:"text-[#a4a3a3] hover:text-[#121314] text-[11px] tracking-[0.44px] font-MonaspaceNeon text-fontTertiary hover:text-fontPrimary transition-all",children:e.name},e.href))})]})},E=()=>(0,a.jsx)("div",{className:"group  bg-fontLight text-gray-800",style:{overflowWrap:"anywhere"},children:(0,a.jsx)("div",{className:"m-auto flex gap-4 p-4 text-base md:max-w-2xl md:gap-6 md:py-6 lg:max-w-5xl lg:px-0",children:(0,a.jsxs)("div",{className:"mx-2 flex w-full   bg-fontLight sm:mx-4 gap-6",children:[(0,a.jsx)("div",{className:"min-w-[40px] items-end",children:(0,a.jsx)("img",{style:{width:"32px",height:"32px",borderRadius:"50%"},src:"https://www.gaianet.ai/icons/icon-bot.png",alt:"bot"})}),(0,a.jsx)("span",{className:"animate-pulse cursor-default mt-1",children:"▍"})]})})});var T=l(21942),z=l(74075),O=l(24888),D=l(88198),Z=l(93625),M=l(67828),R=l(80335),H=l(53281),F=l(93179),G=l(84283);let J={javascript:".js",python:".py",java:".java",c:".c",cpp:".cpp","c++":".cpp","c#":".cs",ruby:".rb",php:".php",swift:".swift","objective-c":".m",kotlin:".kt",typescript:".ts",go:".go",perl:".pl",rust:".rs",scala:".scala",haskell:".hs",lua:".lua",shell:".sh",sql:".sql",html:".html",css:".css"},K=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],l="ABCDEFGHJKLMNPQRSTUVWXY3456789",r="";for(let t=0;t<e;t++)r+=l.charAt(Math.floor(Math.random()*l.length));return t?r.toLowerCase():r},B=(0,n.memo)(e=>{let{language:t,value:l}=e,{t:r}=(0,N.$G)("markdown"),[s,i]=(0,n.useState)(!1),[o,d]=(0,n.useState)(!1),[c,x]=(0,n.useState)({}),p=()=>{navigator.clipboard&&navigator.clipboard.writeText&&navigator.clipboard.writeText(l).then(()=>{i(!0),setTimeout(()=>{i(!1)},2e3)})},m=()=>{let e=J[t]||".file",s="file-".concat(K(3,!0)).concat(e),a=window.prompt(r("Enter file name")||"",s);if(!a)return;let n=new Blob([l],{type:"text/plain"}),i=URL.createObjectURL(n),o=document.createElement("a");o.download=a,o.href=i,o.style.display="none",document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i)},u=async()=>{d(!0);try{let e=await fetch("https://play.rust-lang.org/execute",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({channel:"stable",mode:"debug",crateType:"bin",edition:"2021",code:l,tests:!1})}),t=await e.json();x(t)}catch(e){console.log("run rust error:",e)}d(!1)};return(0,a.jsxs)("div",{className:"codeblock relative font-sans text-[16px] bg-black pb-px",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between py-1.5 px-4",children:[(0,a.jsx)("span",{className:"text-xs lowercase text-white",children:t}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsxs)("button",{className:"flex gap-1.5 items-center rounded bg-none p-1 text-xs text-white",onClick:p,children:[s?(0,a.jsx)(D.Z,{size:18}):(0,a.jsx)(M.Z,{size:18}),s?r("Copied!"):r("Copy code")]}),(0,a.jsx)("button",{className:"flex items-center rounded bg-none p-1 text-xs text-white",onClick:m,children:(0,a.jsx)(R.Z,{size:18})}),"rust"===t&&(0,a.jsx)("button",{className:"flex items-center rounded bg-none p-1 text-xs text-white",onClick:u,children:(0,a.jsx)(H.Z,{size:18})})]})]}),(0,a.jsx)(F.Z,{language:t,style:G.vk,customStyle:{margin:0},children:l}),(Object.keys(c).length>0||o)&&(0,a.jsx)("div",{className:"bg-white m-2 px-4 py-2",children:o?(0,a.jsxs)("div",{className:"text-animation",children:[(0,a.jsx)("span",{children:"⬤"}),(0,a.jsx)("span",{children:"⬤"}),(0,a.jsx)("span",{children:"⬤"})]}):c.success?"> "+c.stdout:c.stderr})]})});B.displayName="CodeBlock";var U=l(10691);let V=(0,n.memo)(U.D,(e,t)=>e.children===t.children);var $=l(62089),W=l(76199);let X=(0,n.memo)(e=>{var t;let{message:l,maxImg:r,messageIndex:s,onRegenerate:i,onEdit:o}=e,{t:d}=(0,N.$G)("chat"),{state:{selectedNode:c,selectedConversation:x,conversations:p,currentMessage:m,messageIsStreaming:u},dispatch:h}=(0,n.useContext)(L),[f,g]=(0,n.useState)(!1),[b,w]=(0,n.useState)(!1),[j,y]=(0,n.useState)(""),[C,k]=(0,n.useState)([]),[S,_]=(0,n.useState)(!1),A=(0,n.useRef)(null),P=()=>{g(!f)},I=e=>{y(e.target.value),A.current&&(A.current.style.height="inherit",A.current.style.height="".concat(A.current.scrollHeight,"px"))},E=()=>{let e=!1,t=!1,r=j,s=H(l.content);C.length>0?((0===s.imgList.length||C.length!==s.imgList.length)&&(t=!0),s.text!==j&&(e=!0),r=[{type:"text",text:j}],C.forEach((e,l)=>{t||e===s.imgList[l]||(t=!0),Array.isArray(r)&&r.push({type:"image_url",image_url:{url:e}})})):(s.imgList.length>0&&(t=!0),l.content!=j&&(e=!0)),(e||t)&&x&&o&&o({...l,content:r}),g(!1)},M=()=>{if(!x)return;let{messages:e}=x,t=e.findIndex(e=>e===l);if(t<0)return;t<e.length-1&&"assistant"===e[t+1].role?e.splice(t,2):e.splice(t,1);let r={...x,messages:e},{single:s,all:a}=v(r,p,null==c?void 0:c.subdomain);h({field:"selectedConversation",value:s}),h({field:"conversations",value:a})},R=e=>{"Enter"!==e.key||b||e.shiftKey||(e.preventDefault(),E())},H=e=>{let t="",l=[];return Array.isArray(e)?e.forEach(e=>{"text"===e.type?t=e.text||"":"image_url"===e.type&&e.image_url&&l.push(e.image_url.url)}):t=e,{text:t,imgList:l}},F=()=>{navigator.clipboard&&navigator.clipboard.writeText(H(l.content).text).then(()=>{_(!0),setTimeout(()=>{_(!1)},2e3)})},G=e=>{let t=H(e);k(t.imgList),y(t.text)};(0,n.useEffect)(()=>{G(l.content)},[l.content]),(0,n.useEffect)(()=>{A.current&&(A.current.style.height="inherit",A.current.style.height="".concat(A.current.scrollHeight,"px"))},[f]);let J=e=>{C.length+e.length<=r?k(t=>[...t,...e]):k(t=>{let l=[...t,...e];return l.slice(-r)})},K=e=>{let t=e.target.files;if(t){let e=[],l=[];for(let r=0;r<t.length;r++){let s=t[r],a=new FileReader;l.push(new Promise(t=>{a.onloadend=()=>{e.push(a.result),t()}})),a.readAsDataURL(s)}Promise.all(l).then(()=>{J(e)})}},U=e=>{k(t=>{let l=[...t];return l.splice(e,1),l})};return(0,a.jsx)("div",{className:"group md:px-4 bg-fontLight text-gray-800 ",style:{overflowWrap:"anywhere"},children:(0,a.jsx)("div",{className:"relative m-auto flex p-4 text-base md:max-w-2xl md:gap-6 lg:max-w-5xl lg:px-0",children:(0,a.jsxs)("div",{className:"mx-2 flex w-full bg-fontLight sm:mx-4 gap-6",children:["assistant"===l.role?(0,a.jsx)("img",{style:{width:"32px",height:"32px",borderRadius:"50%"},src:"https://www.gaianet.ai/icons/icon-bot.png",alt:""}):(0,a.jsx)("img",{style:{width:"32px",height:"32px",borderRadius:"50%"},src:"https://www.gaianet.ai/icons/icon-user.png",alt:""}),(0,a.jsx)("div",{className:"border-b boder-[rgba(0,0,0,.08)] pb-5 flex-1 ",children:"user"===l.role?(0,a.jsxs)("div",{className:"flex w-full",children:[f?(0,a.jsxs)("div",{className:"flex w-full flex-col",children:[(0,a.jsx)("textarea",{ref:A,className:"w-full resize-none whitespace-pre-wrap border-none dark:bg-[#FFFFFF]",value:j,onChange:I,onKeyDown:R,onCompositionStart:()=>w(!0),onCompositionEnd:()=>w(!1),style:{fontFamily:"inherit",fontSize:"inherit",lineHeight:"inherit",padding:"0",margin:"0",overflow:"hidden"}}),(0,a.jsxs)("div",{className:"flex",children:[C.map((e,t)=>(0,a.jsx)("div",{style:{position:"relative",display:"inline-block",marginRight:"10px"},children:(0,a.jsxs)("div",{style:{width:"100px",height:"100px",borderRadius:"5px",border:"1px dashed #ccc",overflow:"hidden",position:"relative"},children:[(0,a.jsx)("img",{src:e,alt:"Uploaded",className:"my-0",style:{width:"100%",height:"100%",objectFit:"cover"}}),(0,a.jsx)("div",{style:{position:"absolute",top:"5px",right:"5px",cursor:"pointer"},onClick:()=>U(t),children:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-x-circle",viewBox:"0 0 16 16",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zM7.354 8l-2.88 2.879a.5.5 0 0 1-.708-.708L6.646 8 3.766 5.121a.5.5 0 0 1 .708-.708L8 7.354l2.879-2.88a.5.5 0 0 1 .708.708L8.354 8l2.879 2.879a.5.5 0 0 1-.708.708L8 8.354 5.121 11.233a.5.5 0 0 1-.708-.708L7.354 8z"})})})]})},t)),(0,a.jsx)("input",{type:"file",accept:"image/*",onChange:K,style:{display:"none"},id:"upload-button"}),(0,a.jsx)("div",{style:{width:"100px",height:"100px",borderRadius:"5px",border:"1px dashed #ccc",overflow:"hidden",cursor:"pointer",textAlign:"center",lineHeight:"100px"},className:"flex justify-center items-center"+(C.length>=r?" hidden":""),onClick:()=>{var e;null===(e=document.getElementById("upload-button"))||void 0===e||e.click()},children:(0,a.jsx)("div",{className:"text-4xl",children:"+"})})]}),(0,a.jsxs)("div",{className:"mt-10 flex justify-center space-x-4",children:[(0,a.jsx)("button",{className:"h-[40px] rounded-md bg-blue-500 px-4 py-1 text-sm font-medium text-white enabled:hover:bg-blue-600 disabled:opacity-50",onClick:E,disabled:j.trim().length<=0,children:d("Save & Submit")}),(0,a.jsx)("button",{className:"h-[40px] rounded-md border border-neutral-300 px-4 py-1 text-sm font-medium text-neutral-700 hover:bg-neutral-100 dark:border-neutral-700 dark:text-neutral-300 dark:hover:bg-neutral-800",onClick:()=>{G(l.content),g(!1)},children:d("Cancel")})]})]}):(0,a.jsxs)("div",{className:"prose whitespace-pre-wrap flex-1 text-[#696868]",children:[H(l.content).text,(0,a.jsx)("div",{className:"flex items-center",children:H(l.content).imgList.map((e,t)=>(0,a.jsx)("div",{style:{marginRight:"10px",flex:1},children:(0,a.jsx)("img",{src:e,alt:"Uploaded"})},t))})]}),!f&&(0,a.jsxs)("div",{className:"md:-mr-8 ml-1 md:ml-0 flex flex-col md:flex-row gap-4 md:gap-1 items-center md:items-start justify-end md:justify-start",children:[(0,a.jsx)("button",{className:"invisible group-hover:visible focus:visible text-gray-500 hover:text-[#322221] ",onClick:P,children:(0,a.jsx)(T.Z,{size:18})}),(0,a.jsx)("button",{className:"invisible group-hover:visible focus:visible text-gray-500 hover:text-[#322221] ",onClick:M,children:(0,a.jsx)(z.Z,{size:18})})]})]}):(0,a.jsxs)("div",{className:"flex flex-row",children:[(0,a.jsx)(V,{className:"dark:prose-invert flex-1 text-[#222228] ReactMarkdown",remarkPlugins:[W.Z],rehypePlugins:[$.Z],components:{code(e){let{node:t,inline:l,className:r,children:s,...n}=e;if(s.length){if("▍"==s[0])return(0,a.jsx)("span",{className:"animate-pulse cursor-default mt-1",children:"▍"});s[0]=s[0].replace("`▍`","▍")}let i=/language-(\w+)/.exec(r||"");return l?(0,a.jsx)("code",{className:r,...n,children:s}):(0,a.jsx)(B,{language:i&&i[1]||"",value:String(s).replace(/\n$/,""),...n},Math.random())},table(e){let{children:t}=e;return(0,a.jsx)("table",{className:"border-collapse border border-black px-3 py-1 ",children:t})},th(e){let{children:t}=e;return(0,a.jsx)("th",{className:"break-words border border-black  px-3 py-1 text-white ",children:t})},td(e){let{children:t}=e;return(0,a.jsx)("td",{className:"break-words border border-black px-3 py-1 ",children:t})}},children:"".concat(l.content.replace(/\$\$(.*?)\$\$/g,(e,t)=>"```math\n"+t+"\n```")).concat(u&&s==(null!==(t=null==x?void 0:x.messages.length)&&void 0!==t?t:0)-1?"`▍`":"")}),(0,a.jsxs)("div",{className:"md:-mr-8 ml-1 md:ml-0 flex flex-col md:flex-row gap-4 md:gap-1 items-center md:items-start justify-end md:justify-start",children:[(0,a.jsx)("button",{className:"invisible group-hover:visible focus:visible text-gray-500 hover:text-[#322221]",onClick:i,children:(0,a.jsx)(O.Z,{size:18})}),S?(0,a.jsx)(D.Z,{size:18,className:"text-green-500 dark:text-green-400"}):(0,a.jsx)("button",{className:"invisible group-hover:visible focus:visible text-gray-500 hover:text-[#322221] ",onClick:F,children:(0,a.jsx)(Z.Z,{size:18})})]})]})})]})})})});X.displayName="ChatMessage";let Y=(0,n.memo)(X,(e,t)=>e.message.content===t.message.content);var q=l(91500),Q=l(87083);let ee=e=>{let{conversation:t,prompts:l,onChangePrompt:r}=e,{t:s}=(0,N.$G)("chat"),{state:{messageIsStreaming:i}}=(0,n.useContext)(L),[o,d]=(0,n.useState)(""),[c,x]=(0,n.useState)(0),[p,m]=(0,n.useState)(!1),[u,h]=(0,n.useState)(""),[f,g]=(0,n.useState)([]),[v,b]=(0,n.useState)(!1),[w,j]=(0,n.useState)(null),[y,C]=(0,n.useState)(!1),k=(0,n.useRef)(null),S=(0,n.useRef)(null);l.filter(e=>e.name.toLowerCase().includes(u.toLowerCase()));let _=e=>{let t=e.target.value;d(t)},A=()=>{if(!o&&1===t.promptState){C(!0);return}I(o),r(o),w&&w.hide()},I=(0,n.useCallback)(e=>{let t=e.match(/\/\w*$/);t?(m(!0),h(t[0].slice(1))):(m(!1),h(""))},[]),E=e=>{let t=null==o?void 0:o.replace(/{{(.*?)}}/g,(t,l)=>{let r=f.indexOf(l);return e[r]});d(t),r(t),k&&k.current&&k.current.focus()};return(0,n.useEffect)(()=>{if(k&&k.current){var e;k.current.style.height="inherit",k.current.style.height="".concat(null===(e=k.current)||void 0===e?void 0:e.scrollHeight,"px")}},[o]),(0,n.useEffect)(()=>{d(t.prompt||"")},[t.prompt]),(0,n.useEffect)(()=>{let e=e=>{S.current&&!S.current.contains(e.target)&&m(!1)};return window.addEventListener("click",e),()=>{window.removeEventListener("click",e)}},[]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Q.ZP,{content:(0,a.jsxs)("div",{className:"flex flex-col w-[285px] p-3 bg-fontLight border border-fontPrimary rounded-[8px] ",children:[(0,a.jsx)("p",{className:"text-black font-StyreneA text-[16px] leading-[24px] tracking-[-0.64px] font-bold mb-4",children:"System Prompt"}),(0,a.jsx)("textarea",{ref:k,className:"w-full resize-none min-h-[150px] max-h-[150px] outline-none rounded-[6px] border text-[14px] leading-[20px] tracking-[0.56px] font-MonaspaceNeon border-fillLine bg-transparent p-[10px] text-fontPrimary placeholder:text-fontTertiary ",placeholder:'Enter a prompt or type "/" to select a prompt...',value:o||"",rows:3,onChange:_}),y&&(0,a.jsx)("div",{className:"text-xs text-[#D43327] mt-1",children:"The prompt of this model cannot be empty!"}),(0,a.jsx)("div",{className:"flex items-center justify-end mt-4 gap-3",children:(0,a.jsx)("div",{className:"inline-flex px-4 py-[7px] uppercase rounded-[100px] border border-fontPrimary cursor-pointer font-MonaspaceNeon text-[15px] tracking-[0.9px] text-fontLight bg-fontPrimary leading-5",onClick:()=>A(),children:"save"})})]}),placement:"bottom-end",trigger:"click",interactive:!0,disabled:i,arrow:!1,onCreate:e=>j(e),className:"gaianet-tippy",children:(0,a.jsxs)("div",{className:"inline-flex items-center justify-center gap-3 rounded-[8px] px-3 h-[46px] border border-fillLine cursor-pointer hover:border-fontPrimary hover:shadow-[0_0_0_3px_rgba(102,16,242,0.15)] transition-all",children:[(0,a.jsx)("p",{className:"text-[12px] leading-[20px] tracking-[0.72px] font-MonaspaceNeon text-black",children:"System Prompt"}),(0,a.jsx)(q.Z,{size:"18",color:"#A4A3A3"})]})}),v&&(0,a.jsx)(P,{prompt:l[c],variables:f,onSubmit:E,onClose:()=>b(!1)})]})};var et=l(36465),el=l.n(et);let er=()=>{let[e,t]=(0,n.useState)(null),{state:{selectedNode:l,messageIsStreaming:r},dispatch:s}=(0,n.useContext)(L);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Q.ZP,{placement:"bottom-end",trigger:"click",interactive:!0,disabled:!0,arrow:!1,onCreate:e=>t(e),className:"gaianet-tippy",children:(0,a.jsxs)("div",{className:"jsx-b45faac4984cf1bd inline-flex items-center justify-between rounded-[8px] gap-3 px-3 w-auto md:min-w-[405px] h-[46px] text-black border border-fillLine cursor-pointer transition-all",children:[(0,a.jsxs)("div",{className:"jsx-b45faac4984cf1bd flex flex-col",children:[(0,a.jsx)("p",{className:"jsx-b45faac4984cf1bd text-[12px] leading-[20px] tracking-[0.72px] font-PPSupplySans text-black ",children:(null==l?void 0:l.subdomain)||"-"}),(0,a.jsx)("p",{className:"jsx-b45faac4984cf1bd text-[11px] leading-[13px] tracking-[0.44px] font-PPSupplySans uppercase mt-[1px] text-fontTertiary",children:(null==l?void 0:l.name)||"-"})]}),(0,a.jsx)(q.Z,{size:"18",color:"#A4A3A3"})]})}),(0,a.jsx)(el(),{id:"b45faac4984cf1bd",children:".loading-dot.jsx-b45faac4984cf1bd{-webkit-animation:loading-dot-flashing 1s infinite linear;-moz-animation:loading-dot-flashing 1s infinite linear;-o-animation:loading-dot-flashing 1s infinite linear;animation:loading-dot-flashing 1s infinite linear}.loading-dot.jsx-b45faac4984cf1bd:nth-child(2){-webkit-animation-delay:.2s;-moz-animation-delay:.2s;-o-animation-delay:.2s;animation-delay:.2s}.loading-dot.jsx-b45faac4984cf1bd:nth-child(3){-webkit-animation-delay:.4s;-moz-animation-delay:.4s;-o-animation-delay:.4s;animation-delay:.4s}@-webkit-keyframes loading-dot-flashing{0%{opacity:1}33%{opacity:0}66%{opacity:0}100%{opacity:1}}@-moz-keyframes loading-dot-flashing{0%{opacity:1}33%{opacity:0}66%{opacity:0}100%{opacity:1}}@-o-keyframes loading-dot-flashing{0%{opacity:1}33%{opacity:0}66%{opacity:0}100%{opacity:1}}@keyframes loading-dot-flashing{0%{opacity:1}33%{opacity:0}66%{opacity:0}100%{opacity:1}}"})]})};var es=l(93967),ea=l.n(es);let en=(0,n.memo)(e=>{var t,l;let r,s;let i,{stopConversationRef:o}=e,{state:{selectedConversation:d,conversations:c,isStream:x,api:p,apiKey:m,pluginKeys:u,loading:h,prompts:g,selectedNode:j},handleUpdateConversation:y,handleNewConversation:C,dispatch:_}=(0,n.useContext)(L),{t:A}=(0,N.$G)("chat"),[P,T]=(0,n.useState)(),[z,O]=(0,n.useState)(0),[D,Z]=(0,n.useState)(!0),[M,R]=(0,n.useState)(!1),[H,F]=(0,n.useState)(!1),G=(0,n.useRef)(null),J=(0,n.useRef)(null),K=(0,n.useRef)(null),B=(0,n.useRef)([]),U="",V=!0,$=(0,n.useRef)(!1),W=!0;async function X(){if(W&&d&&B.current.length>0){W=!1;for(let e=0;e<B.current.length;e++)if(U+=B.current.shift(),U=U.replace(/<\|.*?\|>/g,""),V){V=!1,_({field:"loading",value:!1});let e=[...i.messages,{role:"assistant",content:U||""}];_({field:"selectedConversation",value:i={...i,messages:e}})}else{let e=i.messages.map((e,t)=>t===i.messages.length-1?{...e,content:U}:e);b(i={...i,messages:e}),_({field:"selectedConversation",value:i});let t=c.map(e=>e.id===d.id?i:e);0===t.length&&t.push(i),_({field:"conversations",value:t}),w(t,null==j?void 0:j.subdomain),$.current}W=!0}}let q=async()=>{for(;0!==B.current.length;)await X()},Q=(0,n.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(arguments.length>2&&void 0!==arguments[2]&&arguments[2],d&&j){let r;if(t){let l=[...d.messages];for(let e=0;e<t;e++)l.pop();i={...d,messages:[...l,e]}}else if(i={...d,messages:[...d.messages,e]},0===d.messages.length){var l;i={...i,name:"string"==typeof e.content?e.content:(null===(l=e.content.find(e=>"text"===e.type))||void 0===l?void 0:l.text)||""}}r=i.messages.map(e=>"string"!=typeof e.content?{...e,content:e.content.map(e=>"image_url"===e.type&&e.image_url&&e.image_url.url.startsWith("data:image/")?{...e,image_url:{url:e.image_url.url.split(",")[1]}}:e)}:e),_({field:"selectedConversation",value:i}),_({field:"loading",value:!0}),_({field:"messageIsStreaming",value:!0});let s={node:j,messages:r,key:m,prompt:i.prompt,temperature:i.temperature},a=new AbortController;try{let{node:e,messages:t,key:l,prompt:r,temperature:n}=s,o=n;null==o&&(o=f);let m=[];for(let e=t.length-1;e>=0;e--){let l=t[e];m=[l,...m]}if(x){$.current=!1;let t=await k(e,r,o,p,l,m);if(t){let e="",l=new TextDecoder,r=t.getReader();for(;!$.current;){let{value:t,done:s}=await r.read();s&&($.current=!0);let a=l.decode(t);if(a){let t=a.split("\n\n");t.forEach(t=>{let l=!1;if((t=t.trim()).startsWith("data: ")&&(t=t.substring(6).trim()),"[DONE]"===t?$.current=!0:t.startsWith("{")?t.endsWith("}")||(e=t,l=!0):e?(t=e+t,e=""):l=!0,!l&&!$.current)try{if(t){let e=JSON.parse(t);e&&e.choices&&e.choices.forEach(e=>{e&&e.delta&&e.delta.content&&B.current.push(e.delta.content)}),e&&e.usage&&(console.log("prompt:",e.usage.prompt_tokens),console.log("completion:",e.usage.completion_tokens),console.log("total:",e.usage.total_tokens))}}catch(e){console.log("error JSON",t)}})}W&&q()}_({field:"messageIsStreaming",value:!1}),a.abort()}else _({field:"loading",value:!1}),_({field:"messageIsStreaming",value:!1})}else{let t=await S(e,r,o,p,l,m);if(t){let e=t.choices[0].message,l=[...i.messages,{role:"assistant",content:e.content}];i={...i,messages:l},_({field:"selectedConversation",value:v}),b(i);let r=c.map(e=>e.id===d.id?i:e);0===r.length&&r.push(i),_({field:"conversations",value:r}),w(r,null==j?void 0:j.subdomain),_({field:"loading",value:!1}),_({field:"messageIsStreaming",value:!1}),_({field:"selectedConversation",value:i})}}}catch(e){console.error(e)}}},[p,m,c,u,x,d,o]);(0,n.useCallback)(()=>{if(D){var e,t;null===(e=G.current)||void 0===e||e.scrollIntoView({behavior:"smooth"}),null===(t=K.current)||void 0===t||t.focus()}},[D]);let et=()=>{if(J.current){let{scrollTop:e,scrollHeight:t,clientHeight:l}=J.current;e+l<t-30?(Z(!1),F(!0)):(Z(!0),F(!1))}},el=()=>{var e;null===(e=J.current)||void 0===e||e.scrollTo({top:J.current.scrollHeight,behavior:"smooth"})},es=()=>{if(D){var e;null===(e=G.current)||void 0===e||e.scrollIntoView(!0)}},en=function(){for(var e=arguments.length,t=Array(e),l=0;l<e;l++)t[l]=arguments[l];s?(clearTimeout(r),r=setTimeout(()=>{Date.now()-s>=250&&(es(...t),s=Date.now())},250-(Date.now()-s))):(es(...t),s=Date.now())};return(0,n.useEffect)(()=>{en(),d&&(O(null==d?void 0:d.messages.reduce((e,t)=>(Array.isArray(t.content)&&(e+=t.content.reduce((e,t)=>("image_url"===t.type&&t.image_url&&e++,e),0)),e),0)),T(d.messages[d.messages.length-2]))},[d,en]),(0,n.useEffect)(()=>{let e=new IntersectionObserver(e=>{let[t]=e;if(Z(t.isIntersecting),t.isIntersecting){var l;null===(l=K.current)||void 0===l||l.focus()}},{root:null,threshold:.5}),t=G.current;return t&&e.observe(t),()=>{t&&e.unobserve(t)}},[G]),(0,a.jsxs)("div",{className:"flex flex-col flex-1 overflow-hidden bg-fontLight",children:[(0,a.jsxs)("div",{className:ea()("flex-1 overflow-x-hidden",{charBg:(null==d?void 0:null===(t=d.messages)||void 0===t?void 0:t.length)===0}),ref:J,onScroll:et,children:[(0,a.jsxs)("div",{className:"sticky z-10 bg-fontLight top-0 flex w-full items-center justify-end gap-3 h-[84px] pl-4 md:pl-0 pr-4 md:pr-5",children:[(0,a.jsx)(er,{}),(null==d?void 0:d.promptState)!==2&&d&&(0,a.jsx)(ee,{conversation:d,prompts:g,onChangePrompt:e=>y(d,{key:"prompt",value:e})})]}),!d&&(0,a.jsxs)("div",{className:"mx-auto flex mt-[100px] w-[300px] flex-col justify-center sm:w-[600px]",children:[(0,a.jsx)("img",{src:"./logo-big.png",alt:"",className:"w-[158px] h-[158px] mx-auto"}),(0,a.jsx)("div",{className:"mt-7 text-center text-[32px] leading-[44px] tracking-[-0.32px] font-[500] text-fontPrimary font-StyreneA ",children:"Welcome to Gaia AI Chat"}),(0,a.jsx)("div",{className:"text-center text-fontTertiary mt-3 font-MonaspaceNeon text-[12px] leading-[16px]",children:"Gaia AI Chat lets you interact with various open-source LLMs through an easy-to-use interface."}),(0,a.jsx)("div",{className:"group mx-auto",children:(0,a.jsx)("button",{disabled:!j,className:"mt-6 flex w-[120px] h-[44px] flex-shrink-0 select-none items-center justify-center gap-1 bg-fontPrimary rounded-[200px] text-fontLight  uppercase font-MonaspaceNeon text-[16px] tracking-[0.96px] "+(j?"cursor-pointer":"cursor-not-allowed"),onClick:()=>{C()},children:"Start"})})]}),(null==d?void 0:null===(l=d.messages)||void 0===l?void 0:l.length)!==0&&(0,a.jsxs)("div",{className:"overflow-y-auto",children:[(0,a.jsx)("span",{className:"mt-4 block"}),(null==d?void 0:d.messages)&&d.messages.map((e,t)=>(0,a.jsx)(Y,{message:e,messageIndex:t,maxImg:1-z,onRegenerate:()=>{P&&Q(P,d.messages.length-t+1,null)},onEdit:e=>{T(e),Q(e,(null==d?void 0:d.messages.length)-t)}},t)),h&&(0,a.jsx)(E,{})]})]}),d&&(1!==d.promptState||""!==d.prompt)&&(0,a.jsx)(I,{maxImg:1-z,stopConversationRef:o,textareaRef:K,onSend:(e,t)=>{T(e),Q(e,0,t)},onScrollDownClick:el,onRegenerate:()=>{P&&Q(P,2,null)},showScrollDownButton:H})]})});en.displayName="Chat";let ei=()=>{let e=localStorage.getItem("conversationHistory"),t=localStorage.getItem("folders"),l=localStorage.getItem("prompts");e&&(e=JSON.parse(e)),t&&(t=JSON.parse(t)),l&&(l=JSON.parse(l));let r={version:4,history:e||[],folders:t||[],prompts:l||[]},s=new Blob([JSON.stringify(r,null,2)],{type:"application/json"}),a=URL.createObjectURL(s),n=document.createElement("a");n.download="chatbot_ui_history_".concat(function(){let e=new Date,t=e.getMonth()+1,l=e.getDate();return"".concat(t,"-").concat(l)}(),".json"),n.href=a,n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(a)},eo=e=>{let{history:t,folders:l,prompts:r}=function(e){if(Array.isArray(e))return{version:4,history:g(e),folders:[],prompts:[]};if(!("version"in e)&&"folders"in e&&"history"in e)return{version:4,history:g(e.history||[]),folders:(e.folders||[]).map(e=>({id:e.id.toString(),name:e.name,type:"chat"})),prompts:[]};if(3===e.version)return{...e,version:4,prompts:[]};if(4===e.version)return e;throw Error("Unsupported data format")}(e),s=localStorage.getItem("conversationHistory"),a=s?JSON.parse(s):[],n=[...a,...t].filter((e,t,l)=>t===l.findIndex(t=>t.id===e.id));localStorage.setItem("conversationHistory",JSON.stringify(n)),n.length>0?localStorage.setItem("selectedConversation",JSON.stringify(n[n.length-1])):localStorage.removeItem("selectedConversation");let i=localStorage.getItem("folders"),o=i?JSON.parse(i):[],d=[...o,...l].filter((e,t,l)=>t===l.findIndex(t=>t.id===e.id));localStorage.setItem("folders",JSON.stringify(d));let c=localStorage.getItem("prompts"),x=c?JSON.parse(c):[],p=[...x,...r].filter((e,t,l)=>t===l.findIndex(t=>t.id===e.id));return localStorage.setItem("prompts",JSON.stringify(p)),{version:4,history:n,folders:d,prompts:p}};var ed=l(30471),ec=l(97283);let ex=e=>{let{handleClick:t,children:l}=e;return(0,a.jsx)("button",{className:"min-w-[20px] p-1 text-[#D2D2D2] hover:text-black",onClick:t,children:l})},ep=e=>{let{currentFolder:t,searchTerm:l,handleDrop:r,folderComponent:s}=e,{handleDeleteFolder:i,handleUpdateFolder:o}=(0,n.useContext)(L),[d,c]=(0,n.useState)(!1),[x,p]=(0,n.useState)(!1),[m,u]=(0,n.useState)(""),[h,f]=(0,n.useState)(!1),g=e=>{"Enter"===e.key&&(e.preventDefault(),v())},v=()=>{o(t.id,m),u(""),p(!1)},b=e=>{e.dataTransfer&&(f(!0),r(e,t),e.target.style.background="none")},w=e=>{e.preventDefault()},j=e=>{e.target.style.background="#f7f7f7"},y=e=>{e.target.style.background="none"};return(0,n.useEffect)(()=>{x?c(!1):d&&p(!1)},[x,d]),(0,n.useEffect)(()=>{l?f(!0):f(!1)},[l]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"relative flex items-center ",children:[x?(0,a.jsxs)("div",{className:"flex w-full items-center gap-3 py-3",children:[h?(0,a.jsx)("img",{style:{width:"12px",height:"12px"},src:"./icons/icon-care-down.svg",alt:""}):(0,a.jsx)("img",{style:{width:"12px",height:"12px"},src:"./icons/icon-care-right.svg",alt:""}),(0,a.jsx)("input",{className:"mr-12 flex-1 overflow-hidden overflow-ellipsis border-neutral-400 uppercase bg-transparent text-left text-[13px] leading-5 font-bold text-black outline-none focus:border-neutral-100 fm-SpaceGrotesk",type:"text",value:m,onChange:e=>u(e.target.value),onKeyDown:g,autoFocus:!0})]}):(0,a.jsxs)("div",{className:"w-full h-full relative group flex items-center",children:[(0,a.jsxs)("button",{className:"flex w-full cursor-pointer items-center gap-3 py-3 text-sm transition-colors duration-200 ",onClick:()=>f(!h),onDrop:e=>b(e),onDragOver:w,onDragEnter:j,onDragLeave:y,children:[h?(0,a.jsx)("img",{style:{width:"12px",height:"12px"},src:"./icons/icon-care-down.svg",alt:""}):(0,a.jsx)("img",{style:{width:"12px",height:"12px"},src:"./icons/icon-care-right.svg",alt:""}),(0,a.jsx)("div",{className:"relative max-h-5 flex-1 overflow-hidden text-ellipsis uppercase whitespace-nowrap text-[#000000] font-bold break-all text-left text-[13px] leading-5 fm-SpaceGrotesk bg-fontLight",children:t.name})]}),!d&&!x&&(0,a.jsxs)("div",{className:"absolute right-1 z-10 invisible text-gray-300 group-hover:visible transition-all",children:[(0,a.jsx)(ex,{handleClick:e=>{e.stopPropagation(),p(!0),u(t.name)},children:(0,a.jsx)(ed.Z,{size:18})}),(0,a.jsx)(ex,{handleClick:e=>{e.stopPropagation(),c(!0)},children:(0,a.jsx)(z.Z,{size:18})})]})]}),(d||x)&&(0,a.jsxs)("div",{className:"absolute right-1 z-10 flex text-gray-300",children:[(0,a.jsx)(ex,{handleClick:e=>{e.stopPropagation(),d?i(t.id):x&&v(),c(!1),p(!1)},children:(0,a.jsx)(D.Z,{size:18})}),(0,a.jsx)(ex,{handleClick:e=>{e.stopPropagation(),c(!1),p(!1)},children:(0,a.jsx)(ec.Z,{size:18})})]})]}),h?s:null]})},em=(0,n.createContext)(void 0),eu=e=>{let{conversation:t}=e,{state:{selectedConversation:l,messageIsStreaming:r},handleSelectConversation:s,handleUpdateConversation:i}=(0,n.useContext)(L),{handleDeleteConversation:o}=(0,n.useContext)(em),[d,c]=(0,n.useState)(!1),[x,p]=(0,n.useState)(!1),[m,u]=(0,n.useState)(""),h=e=>{"Enter"===e.key&&(e.preventDefault(),l&&g(l))},f=(e,t)=>{e.dataTransfer&&e.dataTransfer.setData("conversation",JSON.stringify(t))},g=e=>{m.trim().length>0&&(i(e,{key:"name",value:m}),u(""),p(!1))},v=e=>{e.stopPropagation(),d?o(t):x&&g(t),c(!1),p(!1)},b=e=>{e.stopPropagation(),c(!1),p(!1)},w=e=>{e.stopPropagation(),p(!0),l&&u(l.name)},j=e=>{e.stopPropagation(),c(!0)};return(0,n.useEffect)(()=>{x?c(!1):d&&p(!1)},[x,d]),(0,a.jsxs)("div",{className:"relative flex items-center",children:[x&&(null==l?void 0:l.id)===t.id?(0,a.jsxs)("div",{className:"flex w-full items-center gap-2 rounded px-[10px] py-[12px]",children:[(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",className:"flex-shrink-0",children:[(0,a.jsxs)("g",{"clip-path":"url(#clip0_4682_3798)",children:[(0,a.jsx)("path",{d:"M4.50977 5.38184H11.4189V6.47274H4.50977V5.38184ZM4.50977 8.36365H11.4189V9.45456H4.50977V8.36365Z",fill:"#A4A3A3",className:ea()("fill-[#A4A3A3] transition-all group-hover:fill-[#121314]",{"!fill-[#121314]":(null==l?void 0:l.id)===t.id})}),(0,a.jsx)("path",{d:"M8 0.0727539C3.56364 0.0727539 0 3.34548 0 7.41821C0 9.60003 1.01818 11.6364 2.76364 12.9455C2.90909 13.1637 3.2 14.4 3.34545 15.4182C3.34545 15.5637 3.49091 15.7818 3.63636 15.8546C3.70909 15.9273 3.78182 15.9273 3.92727 15.9273C4 15.9273 4.07273 15.9273 4.14545 15.8546L6.47273 14.7637H8C12.4364 14.7637 16 11.4182 16 7.41821C16 3.41821 12.4364 0.0727539 8 0.0727539ZM8 13.6728H6.32727C6.25455 13.6728 6.18182 13.6728 6.10909 13.7455L4.29091 14.5455C4.07273 13.1637 3.78182 12.3637 3.49091 12.1455C1.96364 10.9818 1.16364 9.23639 1.16364 7.41821C1.16364 4.00003 4.21818 1.16366 8.07273 1.16366C11.9273 1.16366 14.9818 4.00003 14.9818 7.41821C14.9818 10.8364 11.7818 13.6728 8 13.6728Z",className:ea()("fill-[#A4A3A3] transition-all group-hover:fill-[#121314]",{"!fill-[#121314]":(null==l?void 0:l.id)===t.id})})]}),(0,a.jsx)("defs",{children:(0,a.jsx)("clipPath",{id:"clip0_4682_3798",children:(0,a.jsx)("rect",{width:"16",height:"16",fill:"white"})})})]}),(0,a.jsx)("input",{className:"mr-12 flex-1 overflow-hidden overflow-ellipsis bg-transparent text-left text-[12px] leading-[12px] font-PPSupplySans text-fontPrimary outline-none ",type:"text",value:m,onChange:e=>u(e.target.value),onKeyDown:h,autoFocus:!0})]}):(0,a.jsxs)("button",{className:"group flex w-full cursor-pointer items-center gap-2 pl-[10px] px-[10px] py-3 text-[12px] leading-[12px] font-PPSupplySans transition-colors duration-200 ".concat(r?"disabled:cursor-not-allowed":""),onClick:()=>s(t),disabled:r,draggable:"true",onDragStart:e=>f(e,t),children:[(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",children:[(0,a.jsxs)("g",{"clip-path":"url(#clip0_4682_3798)",children:[(0,a.jsx)("path",{d:"M4.50977 5.38184H11.4189V6.47274H4.50977V5.38184ZM4.50977 8.36365H11.4189V9.45456H4.50977V8.36365Z",fill:"#A4A3A3",className:ea()("fill-[#A4A3A3] transition-all group-hover:fill-[#121314]",{"!fill-[#121314]":(null==l?void 0:l.id)===t.id})}),(0,a.jsx)("path",{d:"M8 0.0727539C3.56364 0.0727539 0 3.34548 0 7.41821C0 9.60003 1.01818 11.6364 2.76364 12.9455C2.90909 13.1637 3.2 14.4 3.34545 15.4182C3.34545 15.5637 3.49091 15.7818 3.63636 15.8546C3.70909 15.9273 3.78182 15.9273 3.92727 15.9273C4 15.9273 4.07273 15.9273 4.14545 15.8546L6.47273 14.7637H8C12.4364 14.7637 16 11.4182 16 7.41821C16 3.41821 12.4364 0.0727539 8 0.0727539ZM8 13.6728H6.32727C6.25455 13.6728 6.18182 13.6728 6.10909 13.7455L4.29091 14.5455C4.07273 13.1637 3.78182 12.3637 3.49091 12.1455C1.96364 10.9818 1.16364 9.23639 1.16364 7.41821C1.16364 4.00003 4.21818 1.16366 8.07273 1.16366C11.9273 1.16366 14.9818 4.00003 14.9818 7.41821C14.9818 10.8364 11.7818 13.6728 8 13.6728Z",className:ea()("fill-[#A4A3A3] transition-all group-hover:fill-[#121314]",{"!fill-[#121314]":(null==l?void 0:l.id)===t.id})})]}),(0,a.jsx)("defs",{children:(0,a.jsx)("clipPath",{id:"clip0_4682_3798",children:(0,a.jsx)("rect",{width:"16",height:"16",fill:"white"})})})]}),(0,a.jsx)("div",{className:"text-[#a4a3a3] group-hover:text-[#121314] relative max-h-5 flex-1 overflow-hidden text-ellipsis whitespace-nowrap break-all text-left text-[12px] leading-[12px] transition-all pr-[50px] text-fontTertiary group-hover:text-fontPrimary ".concat((null==l?void 0:l.id)===t.id?"!text-[#121314]":"!pr-1"),children:t.name})]}),(d||x)&&(null==l?void 0:l.id)===t.id&&(0,a.jsxs)("div",{className:"absolute right-1 z-10 flex text-fillLine",children:[(0,a.jsx)(ex,{handleClick:v,children:(0,a.jsx)(D.Z,{size:18})}),(0,a.jsx)(ex,{handleClick:b,children:(0,a.jsx)(ec.Z,{size:18})})]}),(null==l?void 0:l.id)===t.id&&!d&&!x&&(0,a.jsxs)("div",{className:"absolute right-1 z-10 flex text-fillLine",children:[(0,a.jsx)(ex,{handleClick:w,children:(0,a.jsx)(ed.Z,{size:18})}),(0,a.jsx)(ex,{handleClick:j,children:(0,a.jsx)(z.Z,{size:18})})]})]})},eh=e=>{let{searchTerm:t}=e,{state:{folders:l,conversations:r,selectedConversation:s},handleUpdateConversation:i}=(0,n.useContext)(L),o=(e,t)=>{if(e.dataTransfer){let l=JSON.parse(e.dataTransfer.getData("conversation"));i(l,{key:"folderId",value:t.id})}},d=e=>r&&r.filter(e=>e.folderId).map((t,l)=>{if(t.folderId===e.id)return(0,a.jsx)("div",{className:"ml-5 gap-2 border-l pl-2 "+(t.id===(null==s?void 0:s.id)?"border-[#121314]":""),children:(0,a.jsx)(eu,{conversation:t})},l)});return(0,a.jsx)("div",{className:"flex w-full flex-col pt-1",children:l.filter(e=>"chat"===e.type).sort((e,t)=>e.name.localeCompare(t.name)).map((e,l)=>(0,a.jsx)(ep,{searchTerm:t,currentFolder:e,handleDrop:o,folderComponent:d(e)},l))})};var ef=l(17010);let eg=e=>{let{open:t,onClose:l}=e,r=(0,n.useRef)(null),[s,i]=(0,n.useState)(!1),{state:{api:o}}=(0,n.useContext)(L);(0,n.useEffect)(()=>{let e=e=>{r.current&&!r.current.contains(e.target)&&window.addEventListener("mouseup",t)},t=e=>{window.removeEventListener("mouseup",t),l()};return window.addEventListener("mousedown",e),()=>{window.removeEventListener("mousedown",e)}},[l]);let d=()=>{navigator.clipboard&&navigator.clipboard.writeText("curl -X POST ".concat(o,"v1/chat/completions  -H 'accept: application/json'  -H 'Content-Type: application/json' -D '").concat(c,"'")).then(()=>{i(!0),setTimeout(()=>{i(!1)},2e3)})};if(!t)return(0,a.jsx)(a.Fragment,{});let c='{"messages":[{"role":"system", "content": "You are a helpful assistant."}, {"role":"user", "content": "Where is Paris?"}]}';return(0,a.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50",children:(0,a.jsx)("div",{className:"fixed inset-0 z-10 overflow-hidden",children:(0,a.jsxs)("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[(0,a.jsx)("div",{className:"hidden sm:inline-block sm:h-screen sm:align-middle","aria-hidden":"true"}),(0,a.jsxs)("div",{ref:r,className:"relative inline-block max-h-[400px] transform overflow-y-auto rounded-lg bg-white p-6 text-left align-bottom shadow-xl transition-all sm:my-8 sm:max-h-[600px] sm:w-full sm:max-w-lg sm:p-6 sm:align-middle",role:"dialog",children:[(0,a.jsx)("div",{className:"text-lg pb-2 font-bold text-black fm-SpaceGrotesk",children:"Send an API request to the node"}),(0,a.jsx)(ec.Z,{size:20,color:"#262626",className:"absolute top-4 right-4 cursor-pointer",onClick:()=>{l()}}),(0,a.jsx)("p",{className:"text-[#696868] text-xs",children:"The node supports the OpenAI JSON format. If you have an OpenAI-based agent or application, you simply need to replace the\xa0api.openai.com\xa0URL in your app with the node's public URL."}),(0,a.jsxs)("div",{className:"w-full bg-[#1E1E1E] rounded-lg overflow-hidden mt-8",children:[(0,a.jsx)("div",{className:"flex items-center justify-end bg-[#302F2F] w-full h-[38px]",children:s?(0,a.jsx)(D.Z,{size:18,className:"text-green-500 dark:text-green-400 mr-4"}):(0,a.jsxs)("p",{className:"flex items-center gap-1 mr-4 cursor-pointer",onClick:d,children:[(0,a.jsx)("span",{className:"capitalize text-sm",children:"copy"}),(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",children:[(0,a.jsx)("path",{d:"M10.8889 1.5H5.80952L2 5.19231V12.1667H10.8889V1.5Z",stroke:"white"}),(0,a.jsx)("path",{d:"M11.3327 4.16675H13.5549V14.8334H4.66602V12.1667",stroke:"white"})]})]})}),(0,a.jsx)("div",{className:"w-full p-5 ",children:(0,a.jsxs)("code",{className:"break-words",children:["curl -X POST ",o," ",(0,a.jsx)("br",{}),"v1/chat/completions \\ ",(0,a.jsx)("br",{}),"\xa0\xa0-H 'accept: application/json' \\",(0,a.jsx)("br",{}),"\xa0\xa0-H 'Content-Type: application/json' \\",(0,a.jsx)("br",{}),"\xa0\xa0-D '",c,"'"]})})]})]})]})})})},ev=()=>(0,a.jsx)("span",{className:"jsx-47ee800305eabab6 gaianetLoader",children:(0,a.jsx)(el(),{id:"47ee800305eabab6",children:".gaianetLoader.jsx-47ee800305eabab6{width:36px;height:36px;border:3px solid#1c1f23;border-bottom-color:transparent;-webkit-border-radius:50%;-moz-border-radius:50%;border-radius:50%;display:inline-block;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;-webkit-animation:rotation 1s linear infinite;-moz-animation:rotation 1s linear infinite;-o-animation:rotation 1s linear infinite;animation:rotation 1s linear infinite}@-webkit-keyframes rotation{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-moz-keyframes rotation{0%{-moz-transform:rotate(0deg);transform:rotate(0deg)}100%{-moz-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes rotation{0%{-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-o-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes rotation{0%{-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);-moz-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}"})}),eb=e=>{let{open:t,onClose:l}=e,r=(0,n.useRef)(null),[s,i]=(0,n.useState)(),[o,d]=(0,n.useState)(!0),{state:{selectedNode:c},dispatch:x}=(0,n.useContext)(L);return((0,n.useEffect)(()=>{(null==c?void 0:c.subdomain)&&fetch("/config_pub.json").then(e=>e.json()).then(e=>{i(e),(null==e?void 0:e.system_prompt)&&x({field:"selectedNodeSystemPrompt",value:null==e?void 0:e.system_prompt}),d(!1)}).catch(e=>{console.error("Error fetching JSON:",e),d(!1)})},[x,c]),(0,n.useEffect)(()=>{let e=e=>{r.current&&!r.current.contains(e.target)&&window.addEventListener("mouseup",t)},t=e=>{window.removeEventListener("mouseup",t),l()};return window.addEventListener("mousedown",e),()=>{window.removeEventListener("mousedown",e)}},[l]),t)?(0,a.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50",children:(0,a.jsx)("div",{className:"fixed inset-0 z-10 overflow-hidden",children:(0,a.jsxs)("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[(0,a.jsx)("div",{className:"hidden sm:inline-block sm:h-screen sm:align-middle","aria-hidden":"true"}),(0,a.jsxs)("div",{ref:r,className:"relative inline-block max-h-[400px] transform overflow-y-auto rounded-lg bg-white p-6 text-left align-bottom shadow-xl transition-all sm:my-8 sm:max-h-[600px] sm:w-full sm:max-w-[600px] sm:p-6 sm:align-middle",role:"dialog",children:[(0,a.jsx)(ec.Z,{size:20,color:"#262626",className:"absolute top-4 right-4 cursor-pointer",onClick:()=>{l()}}),o?(0,a.jsx)("div",{className:"w-full min-h-[280px] flex items-center justify-center",children:(0,a.jsx)(ev,{})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex item-center h-[38px] border-b border-[rgba(0,0,0,.08)]",children:[(0,a.jsx)("p",{className:"font-bold text-black fm-SpaceGrotesk text-base lg:text-lg w-[200px]",children:"Attribute"}),(0,a.jsx)("p",{className:"font-bold text-black fm-SpaceGrotesk text-base lg:text-lg flex-1",children:"Value"})]}),(0,a.jsxs)("div",{className:"flex item-center flex-col lg:flex-row min-h-[38px] border-b border-[rgba(0,0,0,.08)] bg-[#F7F7F7] py-3",children:[(0,a.jsx)("p",{className:"text-[#555555] text-xs w-[200px] pl-3 flex-shrink-0 ",children:"Node ID"}),(0,a.jsx)("p",{className:"text-[#555555] text-xs flex-1 pl-3 lg:pl-0 mt-1 lg:mt-0 break-all",children:(null==s?void 0:s.address)||"-"})]}),(0,a.jsxs)("div",{className:"flex item-center  flex-col lg:flex-row min-h-[38px] border-b border-[rgba(0,0,0,.08)] bg-[#ffffff] py-3",children:[(0,a.jsx)("p",{className:"text-[#555555] text-xs w-[200px] pl-3 flex-shrink-0",children:"GaiaNet Domain"}),(0,a.jsx)("p",{className:"text-[#555555] text-xs flex-1 pl-3 lg:pl-0 mt-1 lg:mt-0 break-all",children:(null==s?void 0:s.domain)||"-"})]}),(0,a.jsxs)("div",{className:"flex item-center flex-col lg:flex-row min-h-[38px] border-b border-[rgba(0,0,0,.08)] bg-[#F7F7F7] py-3",children:[(0,a.jsx)("p",{className:"text-[#555555] text-xs w-[200px] pl-3 flex-shrink-0",children:"Subdomain"}),(0,a.jsx)("p",{className:"text-[#555555] text-xs flex-1 pl-3 lg:pl-0 mt-1 lg:mt-0 break-all",children:(null==s?void 0:s.address)&&(null==s?void 0:s.domain)?"https://".concat(null==s?void 0:s.address,".").concat(null==s?void 0:s.domain):"-"})]}),(0,a.jsxs)("div",{className:"flex item-center flex-col lg:flex-row min-h-[38px] border-b border-[rgba(0,0,0,.08)] bg-[#ffffff] py-3",children:[(0,a.jsx)("p",{className:"text-[#555555] text-xs w-[200px] pl-3 flex-shrink-0",children:"Description"}),(0,a.jsx)("p",{className:"text-[#555555] text-xs flex-1 pl-3 lg:pl-0 mt-1 lg:mt-0 break-all",children:(null==s?void 0:s.description)||"-"})]}),(0,a.jsxs)("div",{className:"flex item-center flex-col lg:flex-row  min-h-[38px] border-b border-[rgba(0,0,0,.08)] bg-[#F7F7F7] py-3",children:[(0,a.jsx)("p",{className:"text-[#555555] text-xs w-[200px] pl-3 flex-shrink-0 ",children:"Fine-tuned LLM"}),(0,a.jsx)("p",{className:"text-[#555555] text-xs flex-1 pl-3 lg:pl-0 mt-1 lg:mt-0 break-all",children:(null==s?void 0:s.chat)?null==s?void 0:s.chat.split("/").pop():"-"})]}),(0,a.jsxs)("div",{className:"flex item-center flex-col lg:flex-row min-h-[38px] border-b border-[rgba(0,0,0,.08)] bg-[#ffffff] py-3",children:[(0,a.jsx)("p",{className:"text-[#555555] text-xs w-[200px] pl-3 flex-shrink-0",children:"System Prompt"}),(0,a.jsx)("p",{className:"text-[#555555] text-xs flex-1 pl-3 lg:pl-0 mt-1 lg:mt-0 break-all",children:(null==s?void 0:s.system_prompt)||"-"})]}),(0,a.jsxs)("div",{className:"flex item-center flex-col lg:flex-row min-h-[38px] border-b border-[rgba(0,0,0,.08)] bg-[#F7F7F7] py-3",children:[(0,a.jsx)("p",{className:"text-[#555555] text-xs w-[200px] pl-3 flex-shrink-0",children:"Embedding Model"}),(0,a.jsx)("p",{className:"text-[#555555] text-xs flex-1 pl-3 lg:pl-0 mt-1 lg:mt-0 break-all",children:(null==s?void 0:s.embedding)?null==s?void 0:s.embedding.split("/").pop():"-"})]}),(0,a.jsxs)("div",{className:"flex item-center flex-col lg:flex-row min-h-[38px] border-b border-[rgba(0,0,0,.08)] bg-[#ffffff] py-3",children:[(0,a.jsx)("p",{className:"text-[#555555] text-xs w-[200px] pl-3 flex-shrink-0",children:"Knowledge Base"}),(0,a.jsx)("p",{className:"text-[#555555] text-xs flex-1 pl-3 lg:pl-0 mt-1 lg:mt-0 break-all",children:(null==s?void 0:s.snapshot)?null==s?void 0:s.snapshot.split("/").pop():"-"})]}),(0,a.jsxs)("div",{className:"flex item-center flex-col lg:flex-row min-h-[38px] border-b border-[rgba(0,0,0,.08)] bg-[#F7F7F7] py-3",children:[(0,a.jsx)("p",{className:"text-[#555555] text-xs w-[200px] pl-3 flex-shrink-0",children:"RAG Prompt"}),(0,a.jsx)("p",{className:"text-[#555555] text-xs flex-1 pl-3 lg:pl-0 mt-1 lg:mt-0 break-all",children:(null==s?void 0:s.rag_prompt)||"-"})]})]})]})]})})}):(0,a.jsx)(a.Fragment,{})},ew=e=>{let{text:t,icon:l,hoverIcon:r,onClick:s}=e;return(0,a.jsxs)("button",{className:"text-[#a4a3a3] hover:text-[#121314] flex w-full cursor-pointer select-none items-center gap-3 rounded-md py-3 px-5 text-[12px] leading-[12px] text-fontTertiary transition-colors duration-200 hover:text-fontPrimary font-PPSupplySans group",onClick:s,children:[(0,a.jsx)("div",{className:ea()({"group-hover:hidden":r}),children:l}),(0,a.jsx)("div",{className:ea()("hidden",{"group-hover:block":r}),children:r}),(0,a.jsx)("span",{className:"capitalize",children:t})]})},ej=e=>{let{onClearConversations:t}=e,[l,r]=(0,n.useState)(!1),{t:s}=(0,N.$G)("sidebar"),i=()=>{t(),r(!1)};return l?(0,a.jsxs)("div",{className:"flex w-full cursor-pointer items-center rounded-lg py-3 px-4 hover:bg-[#fafafa]",children:[(0,a.jsx)(z.Z,{size:18,color:"#322221"}),(0,a.jsx)("div",{className:"ml-3 flex-1 text-left text-[14px] leading-3 text-[#322221] fm-SpaceGrotesk",children:s("Are you sure?")}),(0,a.jsxs)("div",{className:"flex w-[40px]",children:[(0,a.jsx)(D.Z,{className:"ml-auto mr-1 min-w-[20px] text-neutral-400 hover:text-[#322221]",size:18,onClick:e=>{e.stopPropagation(),i()}}),(0,a.jsx)(ec.Z,{className:"ml-auto min-w-[20px] text-neutral-400 hover:text-[#322221]",size:18,onClick:e=>{e.stopPropagation(),r(!1)}})]})]}):(0,a.jsx)(ew,{text:s("Clear conversations"),icon:(0,a.jsx)(z.Z,{size:18}),onClick:()=>r(!0)})},ey=()=>{let{t:e}=(0,N.$G)("sidebar"),[t,l]=(0,n.useState)(!1),[r,s]=(0,n.useState)(!1),[i,o]=(0,n.useState)(!1),{state:{conversations:d},dispatch:c}=(0,n.useContext)(L),{handleClearConversations:x,handleImportConversations:p,handleExportData:m,handleApiChange:u,handleApiKeyChange:h}=(0,n.useContext)(em);return(0,a.jsxs)("div",{className:"flex flex-col items-center pb-[18px]",children:[d.length>0?(0,a.jsx)(ej,{onClearConversations:x}):null,(0,a.jsx)(ew,{text:"API Tutorial",icon:(0,a.jsx)("img",{style:{width:"18px",height:"18px"},src:"./icons/api-tutorial.png",alt:""}),hoverIcon:(0,a.jsx)("img",{style:{width:"18px",height:"18px"},src:"./icons/APITutorial.png",alt:""}),onClick:()=>o(!0)}),(0,a.jsx)(ew,{text:"node info",icon:(0,a.jsx)(ef.Z,{size:18}),onClick:()=>l(!0)}),(0,a.jsx)(eg,{open:i,onClose:()=>{o(!1)}}),(0,a.jsx)(eb,{open:t,onClose:()=>{l(!1)}})]})},eC=e=>{let{conversations:t}=e;return(0,a.jsx)("div",{className:"flex w-full flex-col gap-1",children:t.filter(e=>!e.folderId).slice().reverse().map((e,t)=>(0,a.jsx)(eu,{conversation:e},t))})};var eN=l(16745),ek=l(67421),eS=l(98963),eL=l(89014);let e_=e=>{let{onClick:t,side:l}=e;return(0,a.jsx)("button",{className:"fixed top-0 sm:top-[80px] ".concat("right"===l?"right-[260px]":"left-[260px]"," z-50 h-14 w-7 hover:text-gray-400 dark:text-white dark:hover:text-gray-300 sm:").concat("right"===l?"right-[260px]":"left-[260px]"," sm:h-[84px] sm:w-8 sm:text-neutral-700"),onClick:t,children:"right"===l?(0,a.jsx)(eS.Z,{color:"#A4A3A3"}):(0,a.jsx)(eL.Z,{color:"#A4A3A3"})})},eA=e=>{let{onClick:t,side:l}=e;return(0,a.jsx)("button",{className:"fixed top-[43px] sm:top-[80px] ".concat("right"===l?"right-2":"left-2"," z-50 h-14 w-7 text-white hover:text-gray-400 dark:text-white dark:hover:text-gray-300 sm:").concat("right"===l?"right-2":"left-2"," sm:h-[84px] sm:w-8 sm:text-neutral-700"),onClick:t,children:"right"===l?(0,a.jsx)(eL.Z,{color:"#A4A3A3"}):(0,a.jsx)(eS.Z,{color:"#A4A3A3"})})},eP=e=>{let{t}=(0,N.$G)("sidebar"),{placeholder:l,searchTerm:r,onSearch:s,...n}=e,i=e=>{s(e.target.value)},o=()=>{s("")};return(0,a.jsxs)("div",{className:ea()("relative flex items-center ",null==n?void 0:n.className),children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",className:"absolute left-2",children:(0,a.jsx)("path",{d:"M12.7508 11.35L14.9008 13.5C15.1008 13.7 15.1008 14 14.9008 14.2L14.2008 14.9C14.0008 15.1 13.7008 15.1 13.5008 14.9L11.4008 12.8C10.3008 13.6 9.00078 14.05 7.55078 14.05C3.95078 14.05 1.05078 11.15 1.05078 7.55005C1.05078 3.95005 3.95078 1.05005 7.55078 1.05005C11.1508 1.05005 14.0508 3.95005 14.0508 7.55005C14.0008 8.95005 13.5508 10.25 12.7508 11.35ZM7.50078 13C10.5508 13 13.0008 10.55 13.0008 7.50005C13.0008 4.45005 10.5508 2.00005 7.50078 2.00005C4.45078 2.00005 2.00078 4.45005 2.00078 7.50005C2.00078 10.55 4.45078 13 7.50078 13Z",fill:"#A4A3A3"})}),(0,a.jsx)("input",{className:"bg-fillBackground w-full flex-1 rounded-[4px] outline-none pl-9 py-3 pr-10 text-[12px] leading-[20px] tracking-[0.96px] text-fontPrimary font-PPSupplySans",type:"text",placeholder:l||"",value:r,onChange:i}),r&&(0,a.jsx)(ec.Z,{className:"absolute z-10 right-4 cursor-pointer text-fontPrimary",size:18,onClick:o})]})},eI=e=>{let{isOpen:t,addItemButtonTitle:l,canCreateChat:r,side:s,items:n,itemComponent:i,folderComponent:o,footerComponent:d,searchTerm:c,handleSearchTerm:x,toggleOpen:p,handleCreateItem:m,handleCreateFolder:u,handleDrop:h}=e,{t:f}=(0,ek.$G)("promptbar"),g=e=>{e.preventDefault()},v=e=>{e.target.style.background="#343541"},b=e=>{e.target.style.background="none"};return t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"w-[248px] h-full fixed top-0 ".concat(s,"-0 z-40 sm:").concat(s,"-auto sm:top-auto sm:relative"),children:[(0,a.jsxs)("div",{className:"flex flex-col h-full max-h-full w-full border-r border-fillLine bg-fontLight transition-all sm:relative sm:top-0",children:[(0,a.jsxs)("div",{className:"w-full flex-1 flex flex-col pt-8 overflow-auto",children:[(0,a.jsxs)("div",{className:"px-5",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"group",children:(0,a.jsx)("button",{disabled:!r,className:"flex w-[150px] h-[44px] flex-shrink-0 select-none items-center text-[16px] leading-[20px] tracking-[0.96px] justify-center gap-1 bg-fontPrimary rounded-[200px] text-fontLight transition-colors duration-200 uppercase font-MonaspaceNeon "+(r?"cursor-pointer":"cursor-not-allowed"),onClick:()=>{m(),x("")},children:l})}),(0,a.jsx)("div",{className:"group",children:(0,a.jsx)("button",{disabled:!r,className:"group flex flex-shrink-0 items-center justify-center border border-fillLine transition-all rounded-[22px] w-[44px] h-[44px]  "+(r&&(null==n?void 0:n.length)>0?"cursor-pointer hover:bg-fontPrimary":"cursor-not-allowed"),onClick:u,children:(0,a.jsx)(eN.Z,{size:16,className:"text-[#322221] "+(r&&(null==n?void 0:n.length)>0?"group-hover:text-[#ffffff]":"")})})})]}),(0,a.jsx)(eP,{className:"mt-7",placeholder:f("Search...")||"",searchTerm:c,onSearch:x})]}),(0,a.jsxs)("div",{className:"flex-grow overflow-auto hiddenScrollBar",children:[(null==n?void 0:n.length)>0&&(0,a.jsx)("div",{className:"px-4 ",children:(0,a.jsx)("div",{className:"flex border-b border-white/20 pb-2",children:o})}),(null==n?void 0:n.length)>0&&(0,a.jsx)("div",{className:"pt-2 border-t border-[rgba(0,0,0,0.15)] px-4",onDrop:h,onDragOver:g,onDragEnter:v,onDragLeave:b,children:i})]})]}),d]}),(0,a.jsx)(e_,{onClick:p,side:s})]}),(0,a.jsx)("div",{onClick:p,className:"fixed top-0 left-0 z-30 h-full w-full bg-black opacity-70 sm:hidden"})]}):(0,a.jsx)(eA,{onClick:p,side:s})},eE={searchTerm:"",filteredConversations:[]},eT=()=>{let e=x({initialState:eE}),{state:{conversations:t,showChatbar:l,models:r,folders:s,pluginKeys:i,selectedNode:o,messageIsStreaming:d},dispatch:c,handleCreateFolder:p,handleNewConversation:m,handleUpdateConversation:u}=(0,n.useContext)(L),{state:{searchTerm:h,filteredConversations:f},dispatch:g}=e,v=(0,n.useCallback)(e=>{c({field:"api",value:e}),localStorage.setItem("api",e)},[c]),y=(0,n.useCallback)(e=>{c({field:"apiKey",value:e}),localStorage.setItem("apiKey",e)},[c]),C=e=>{if(i.some(t=>t.pluginId===e.pluginId)){let t=i.map(t=>t.pluginId===e.pluginId?e:t);c({field:"pluginKeys",value:t}),localStorage.setItem("pluginKeys",JSON.stringify(t))}else c({field:"pluginKeys",value:[...i,e]}),localStorage.setItem("pluginKeys",JSON.stringify([...i,e]))},N=e=>{let t=i.filter(t=>t.pluginId!==e.pluginId);if(0===t.length){c({field:"pluginKeys",value:[]}),localStorage.removeItem("pluginKeys");return}c({field:"pluginKeys",value:t}),localStorage.setItem("pluginKeys",JSON.stringify(t))},k=()=>{ei()},S=e=>{let{history:t,folders:l,prompts:r}=eo(e);c({field:"conversations",value:t}),c({field:"selectedConversation",value:t[t.length-1]}),c({field:"folders",value:l}),c({field:"prompts",value:r}),window.location.reload()},_=()=>{c({field:"conversations",value:[]}),c({field:"selectedConversation",value:null}),localStorage.removeItem("conversationHistory"),localStorage.removeItem("selectedConversation");let e=s.filter(e=>"chat"!==e.type);c({field:"folders",value:e}),j(e)},A=e=>{let l=t.filter(t=>t.id!==e.id);c({field:"conversations",value:l}),g({field:"searchTerm",value:""}),w(l,null==o?void 0:o.subdomain),l.length>0?(c({field:"selectedConversation",value:l[l.length-1]}),b(l[l.length-1])):(c({field:"selectedConversation",value:null}),localStorage.removeItem("selectedConversation"))},P=()=>{c({field:"showChatbar",value:!l}),localStorage.setItem("showChatbar",JSON.stringify(!l))},I=e=>{if(e.dataTransfer){let t=JSON.parse(e.dataTransfer.getData("conversation"));u(t,{key:"folderId",value:0}),g({field:"searchTerm",value:""}),e.target.style.background="none"}};return(0,n.useEffect)(()=>{h?g({field:"filteredConversations",value:t.filter(e=>{let t=e.name.toLocaleLowerCase()+" "+e.messages.map(e=>e.content).join(" ");return t.toLowerCase().includes(h.toLowerCase())})}):g({field:"filteredConversations",value:t})},[h,t]),(0,a.jsx)(em.Provider,{value:{...e,handleDeleteConversation:A,handleClearConversations:_,handleImportConversations:S,handleExportData:k,handlePluginKeyChange:C,handleClearPluginKey:N,handleApiChange:v,handleApiKeyChange:y},children:(0,a.jsx)(eI,{side:"left",isOpen:l,canCreateChat:!!o&&!d,addItemButtonTitle:"New chat",itemComponent:(0,a.jsx)(eC,{conversations:f}),folderComponent:(0,a.jsx)(eh,{searchTerm:h}),items:f,searchTerm:h,handleSearchTerm:e=>g({field:"searchTerm",value:e}),toggleOpen:P,handleCreateItem:m,handleCreateFolder:()=>p("New folder","chat"),handleDrop:I,footerComponent:(0,a.jsx)(ey,{})})})};var ez=l(1177);let eO=e=>{let{selectedConversation:t,onNewConversation:l}=e;return(0,a.jsxs)("nav",{className:"flex w-full justify-between bg-fontLight py-3 px-4 border-b border-[rgba(0,0,0,.08)]",children:[(0,a.jsx)("div",{className:"mr-4"}),(0,a.jsx)("div",{className:"max-w-[240px] overflow-hidden text-ellipsis whitespace-nowrap text-[#322221]",children:null==t?void 0:t.name}),(0,a.jsx)(ez.Z,{className:"cursor-pointer hover:text-neutral-400 mr-8",onClick:l})]})},eD={api:"..",apiKey:"",loading:!1,pluginKeys:[],lightMode:"dark",isStream:!0,messageIsStreaming:!1,modelError:null,models:[],folders:[],conversations:[],selectedConversation:void 0,currentMessage:void 0,prompts:[],temperature:1,showPromptbar:!0,showChatbar:!0,currentFolder:void 0,messageError:!1,searchTerm:"",defaultModelId:void 0,selectedNode:void 0,selectedNodeSystemPrompt:""};var eZ=l(57632);let eM=e=>{let{}=e,{getModels:t}=m(),l=x({initialState:eD}),{state:{folders:r,conversations:s,selectedConversation:i,prompts:d,selectedNode:p,selectedNodeSystemPrompt:u},dispatch:h}=l,N=(0,n.useRef)(!1),k=async()=>{let e=window.location.hostname;try{let l=await t({url:e,key:""});h&&(h({field:"selectedNode",value:l}),localStorage.setItem("selectedNode",JSON.stringify(l)),h({field:"modelError",value:null}))}catch(e){console.log(e)}};(0,n.useEffect)(()=>{k()},[]);let S=e=>{h({field:"selectedConversation",value:e}),b(e)},_=async(e,t)=>{let l={id:(0,eZ.Z)(),name:e,type:t},s=[...r,l];h({field:"folders",value:s}),j(s)},A=e=>{let t=r.filter(t=>t.id!==e);h({field:"folders",value:t}),j(t);let l=s.map(t=>t.folderId===e?{...t,folderId:null}:t);h({field:"conversations",value:l}),w(l,null==p?void 0:p.subdomain);let a=d.map(t=>t.folderId===e?{...t,folderId:null}:t);h({field:"prompts",value:a}),y(a)},P=(e,t)=>{let l=r.map(l=>l.id===e?{...l,name:t}:l);h({field:"folders",value:l}),j(l)},I=async()=>{if(!p)return;let e={id:(0,eZ.Z)(),name:"New Conversation",messages:[],node:p,prompt:u||"",promptState:0,temperature:f,folderId:null},t=[...s,e];h({field:"selectedConversation",value:e}),h({field:"conversations",value:t}),b(e),w(t,null==p?void 0:p.subdomain),h({field:"loading",value:!1})},E=(e,t)=>{let l={...e,[t.key]:t.value},{single:r,all:a}=v(l,s,null==p?void 0:p.subdomain);h({field:"selectedConversation",value:r}),h({field:"conversations",value:a})},T=(e,t)=>{let l=Object.assign(e);t.forEach(e=>{l[e.key]=e.value});let{single:r,all:a}=v(l,s,null==p?void 0:p.subdomain);h({field:"selectedConversation",value:r}),h({field:"conversations",value:a})};return(0,n.useEffect)(()=>{window.innerWidth<640&&h({field:"showChatbar",value:!1})},[i]),(0,n.useEffect)(()=>{let e=C();e.isStream&&h({field:"isStream",value:e.isStream});let t=localStorage.getItem("apiKey");t&&h({field:"apiKey",value:t});let l=localStorage.getItem("pluginKeys");l&&h({field:"pluginKeys",value:l}),window.innerWidth<640&&h({field:"showChatbar",value:!1});let r=localStorage.getItem("showChatbar");r&&h({field:"showChatbar",value:"true"===r});let s=localStorage.getItem("prompts");s&&h({field:"prompts",value:JSON.parse(s)});let a=localStorage.getItem("folders");a&&h({field:"folders",value:JSON.parse(a)})},[h]),(0,n.useEffect)(()=>{if(!(null==p?void 0:p.subdomain))return;let e=localStorage.getItem("conversationHistory"),t=localStorage.getItem("selectedConversation");if(t){let e=JSON.parse(t);h({field:"selectedConversation",value:e})}if(e){let t=JSON.parse(e),l=g(t);h({field:"conversations",value:l})}else h({field:"conversations",value:[]})},[h,null==p?void 0:p.subdomain]),(0,a.jsxs)(L.Provider,{value:{...l,handleNewConversation:I,handleCreateFolder:_,handleDeleteFolder:A,handleUpdateFolder:P,handleSelectConversation:S,handleUpdateConversation:E,handleUpdateConversationAll:T},children:[(0,a.jsxs)(c(),{children:[(0,a.jsx)("title",{children:"Gaia"}),(0,a.jsx)("meta",{name:"description",content:"ChatGPT but better."}),(0,a.jsx)("meta",{name:"viewport",content:"height=device-height ,width=device-width, initial-scale=1, user-scalable=no"}),(0,a.jsx)("link",{rel:"icon",href:"/favicon.ico"}),(0,a.jsx)("link",{rel:"icon",href:"https://www.gaianet.ai/favicon.ico"})]}),(0,a.jsxs)("main",{id:"chat-root",className:"overflow-hidden flex h-screen w-screen flex-col text-sm text-white dark:text-white light",children:[(0,a.jsx)("div",{className:"w-full h-[46px] md:h-[96px] pl-[12px] pr-[16px] md:pl-[40px] md:pr-[40px] flex-crossCenter justify-between transition-all bg-fontLight",children:(0,a.jsx)(o(),{href:"/",children:(0,a.jsx)("img",{className:"w-[60px] md:w-[108px] cursor-pointer wow animate__animated animate__fadeIn",src:"https://www.gaianet.ai/images/logo-dark.png",alt:""})})}),(0,a.jsx)("div",{className:"fixed top-[47px] w-full sm:hidden",children:(0,a.jsx)(eO,{selectedConversation:i,onNewConversation:I})}),(0,a.jsxs)("div",{className:"flex h-full w-full pt-[49px] sm:pt-0 border-t border-fillLine",children:[(0,a.jsx)(eT,{}),(0,a.jsx)("div",{className:"flex flex-1",children:(0,a.jsx)(en,{stopConversationRef:N})})]})]})]})};var eR=eM}},function(e){e.O(0,[265,737,774,888,179],function(){return e(e.s=48312)}),_N_E=e.O()}]);